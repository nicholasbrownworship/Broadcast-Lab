<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sponsor Manager – Ozark Invitational</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Manage sponsors for the Ozark Invitational broadcast overlays." />
  <link rel="stylesheet" href="styles.css" />

  <style>
    .sponsor-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .sponsor-layout {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.4fr);
      gap: 16px;
    }

    @media (max-width: 880px) {
      .sponsor-layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .sponsor-hint {
      font-size: 0.8rem;
      color: var(--muted);
      margin-top: 4px;
    }

    .sponsor-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 8px;
    }

    .sponsor-card {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 10px 12px;
      border-radius: var(--radius-md);
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.5);
    }

    body.theme-light .sponsor-card {
      background: #ffffff;
      border-color: rgba(148, 163, 184, 0.4);
    }

    .sponsor-card-main {
      display: flex;
      flex-direction: column;
      gap: 2px;
      min-width: 0;
    }

    .sponsor-name {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .sponsor-line {
      font-size: 0.8rem;
      color: rgba(229, 231, 235, 0.9);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    body.theme-light .sponsor-line {
      color: #4b5563;
    }

    .sponsor-meta {
      font-size: 0.75rem;
      color: var(--muted);
    }

    .sponsor-tier-pill {
      display: inline-flex;
      align-items: center;
      padding: 1px 7px;
      border-radius: 999px;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      border: 1px solid rgba(148, 163, 184, 0.75);
      margin-right: 6px;
    }

    .sponsor-card-actions {
      display: flex;
      flex-shrink: 0;
      align-items: center;
      gap: 6px;
    }

    .sponsor-btn {
      border-radius: 999px;
      padding: 4px 9px;
      font-size: 0.75rem;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.85);
      color: #e5e7eb;
      cursor: pointer;
    }

    body.theme-light .sponsor-btn {
      background: rgba(255, 255, 255, 0.96);
      color: #111827;
      border-color: rgba(148, 163, 184, 0.6);
    }

    .sponsor-btn--danger {
      border-color: rgba(248, 113, 113, 0.9);
      color: #fecaca;
      background: rgba(127, 29, 29, 0.9);
    }

    body.theme-light .sponsor-btn--danger {
      color: #991b1b;
      background: #fee2e2;
      border-color: rgba(248, 113, 113, 0.9);
    }

    .muted {
      font-size: 0.8rem;
      color: var(--muted);
    }

    .sponsor-footer-note {
      font-size: 0.75rem;
      color: var(--muted);
      margin-top: 6px;
    }
  </style>
</head>
<body>
  <div class="lab-shell">
    <!-- TOPBAR -->
    <header class="lab-topbar">
      <div class="brand-lockup">
        <div class="brand-mark">OI</div>
        <div>
          <div class="brand-title">Ozark Invitational</div>
          <div class="brand-subtitle">Sponsor Manager</div>
        </div>
      </div>
      <div class="topbar-actions">
        <a href="index.html" class="ghost-btn">
          ⟵ Back to Broadcast Lab
        </a>
      </div>
    </header>

    <main class="sponsor-main">
      <section class="sponsor-layout">
        <!-- LEFT: CREATE / EDIT FORM -->
        <section class="panel">
          <div class="panel-header">
            <h2>Add Sponsor</h2>
            <p class="panel-subtitle">
              Create sponsor lines to use in your lower thirds, score bugs, and slates.
            </p>
          </div>

          <form id="sponsorForm" class="field-grid">
            <div class="field">
              <span class="field-label">Sponsor name</span>
              <input id="sponsorName" type="text" placeholder="+3 Golf Co." />
            </div>

            <div class="field">
              <span class="field-label">Overlay line</span>
              <input id="sponsorLine" type="text" placeholder="Presented by +3 Golf Co." />
              <p class="sponsor-hint">
                If left blank, we’ll use: “Presented by &lt;Sponsor name&gt;”.
              </p>
            </div>

            <div class="field">
              <span class="field-label">Tier</span>
              <select id="sponsorTier">
                <option value="primary">Primary / Title Sponsor</option>
                <option value="feature">Feature Segment Sponsor</option>
                <option value="supporting">Supporting Sponsor</option>
              </select>
            </div>

            <div class="field">
              <span class="field-label">Notes (optional)</span>
              <textarea id="sponsorNotes" rows="2" style="resize: vertical; border-radius: var(--radius-md); border: 1px solid rgba(148,163,184,0.4); padding: 7px 10px; background: rgba(15,23,42,0.8); color: #f9fafb; font-size: 0.85rem;"></textarea>
            </div>

            <div class="field">
              <button type="submit" class="ghost-btn">
                Save Sponsor
              </button>
            </div>
          </form>

          <p class="sponsor-footer-note">
            Sponsors are saved locally in this browser (localStorage key: <code>ozarkSponsors_v1</code>) and show up in the Broadcast Lab “Saved sponsors” dropdown.
          </p>
        </section>

        <!-- RIGHT: SPONSOR LIST -->
        <section class="panel">
          <div class="panel-header">
            <h2>Saved Sponsors</h2>
            <p class="panel-subtitle">
              Click “Use in Broadcast” from the Lab to drop these lines into your overlays.
            </p>
          </div>

          <div id="sponsorList" class="sponsor-list">
            <!-- dynamically populated -->
          </div>
        </section>
      </section>
    </main>
  </div>

  <script>
    (function () {
      const STORAGE_KEY = "ozarkSponsors_v1";

      const form = document.getElementById("sponsorForm");
      const nameInput = document.getElementById("sponsorName");
      const lineInput = document.getElementById("sponsorLine");
      const tierSelect = document.getElementById("sponsorTier");
      const notesInput = document.getElementById("sponsorNotes");
      const listEl = document.getElementById("sponsorList");

      function loadSponsors() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          if (!raw) return [];
          const parsed = JSON.parse(raw);
          return Array.isArray(parsed) ? parsed : [];
        } catch (e) {
          console.warn("Error loading sponsors", e);
          return [];
        }
      }

      function saveSponsors(list) {
        try {
          localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
        } catch (e) {
          console.warn("Error saving sponsors", e);
        }
      }

      function tierLabel(tier) {
        if (tier === "primary") return "Primary";
        if (tier === "feature") return "Feature";
        if (tier === "supporting") return "Supporting";
        return "Other";
      }

      function renderSponsors() {
        const sponsors = loadSponsors();
        if (!sponsors.length) {
          listEl.innerHTML = '<p class="muted">No sponsors yet. Add a sponsor on the left to get started.</p>';
          return;
        }

        listEl.innerHTML = "";
        sponsors.forEach((sp) => {
          const card = document.createElement("div");
          card.className = "sponsor-card";
          card.innerHTML = `
            <div class="sponsor-card-main">
              <div class="sponsor-name">${sp.name || "(Unnamed sponsor)"}</div>
              <div class="sponsor-line">${sp.line || ""}</div>
              <div class="sponsor-meta">
                <span class="sponsor-tier-pill">${tierLabel(sp.tier)}</span>
                ${sp.notes ? `<span>${sp.notes}</span>` : ""}
              </div>
            </div>
            <div class="sponsor-card-actions">
              <button class="sponsor-btn sponsor-btn--danger" data-action="delete" data-id="${sp.id}">
                Delete
              </button>
            </div>
          `;
          listEl.appendChild(card);
        });
      }

      function addSponsor(evt) {
        evt.preventDefault();

        const name = (nameInput.value || "").trim();
        let line = (lineInput.value || "").trim();
        const tier = tierSelect.value || "supporting";
        const notes = (notesInput.value || "").trim();

        if (!name) {
          alert("Please enter a sponsor name.");
          return;
        }

        if (!line) {
          line = "Presented by " + name;
        }

        const sponsors = loadSponsors();
        sponsors.push({
          id: Date.now().toString(),
          name,
          line,
          tier,
          notes
        });

        saveSponsors(sponsors);
        renderSponsors();

        nameInput.value = "";
        lineInput.value = "";
        notesInput.value = "";
        tierSelect.value = "primary";
      }

      function handleListClick(evt) {
        const btn = evt.target.closest("[data-action]");
        if (!btn) return;

        const id = btn.getAttribute("data-id");
        if (!id) return;

        if (btn.getAttribute("data-action") === "delete") {
          const sponsors = loadSponsors().filter((sp) => sp.id !== id);
          saveSponsors(sponsors);
          renderSponsors();
        }
      }

      if (form) {
        form.addEventListener("submit", addSponsor);
      }

      if (listEl) {
        listEl.addEventListener("click", handleListClick);
      }

      renderSponsors();
    })();
  </script>
</body>
</html>
